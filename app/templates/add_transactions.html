{% extends "base.html" %}
{% block title %}Edit Transactions{% endblock %}
{% block content %}

<div class="container min-vh-100 d-flex flex-column align-items-center pt-5">

  <div class="col-12 col-md-10 col-lg-8">

    <h1 class="mb-4 text-center">Edit Transactions</h1>

<!-- Add New Transaction -->
<div class="card mb-5">
  <div class="card-body">
    <h5 class="card-title">Add New Transaction</h5>
    <form method="POST" action="{{ url_for('transactions.add_transaction') }}">
      {{ form.hidden_tag() }}

      <div class="row g-3 align-items-end">

        <div class="col">
          <label for="date" class="form-label">Date</label>
          <input type="date" name="date" class="form-control" required>
        </div>

        <div class="col">
          <label for="description" class="form-label">Description</label>
          <input type="text" name="description" class="form-control" required>
        </div>

        <div class="col">
          <label for="category" class="form-label">Category</label>
          <input type="text" name="category" class="form-control" required>
        </div>

        <div class="col">
          <label for="amount" class="form-label">Amount</label>
          <input type="number" step="0.01" name="amount" class="form-control" required>
        </div>

        <div class="col">
          <label for="balance" class="form-label">Balance</label>
          <input type="number" step="0.01" name="balance" class="form-control" required>
        </div>

        <div class="col-auto">
          <button type="submit" class="btn btn-success">Add</button>
        </div>

      </div>

    </form>
  </div>
</div>


    <!-- Display Transactions with Checkboxes -->
    <div class="card mb-5">
      <div class="card-body">

        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="card-title mb-0">Existing Transactions</h5>
          <form method="POST" action="{{ url_for('transactions.delete_transactions') }}" class="mb-0">
            <button type="submit" class="btn btn-danger">Delete Selected</button>
        </div>

        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
              <tr>
                <th><input type="checkbox" id="select-all"></th>
                <th>Date</th>
                <th>Description</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Balance</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for transaction in transactions %}
              <tr>
                <td><input type="checkbox" name="transaction_ids" value="{{ transaction.id }}"></td>
                <td>{{ transaction.date }}</td>
                <td>{{ transaction.description }}</td>
                <td>{{ transaction.category }}</td>
                <td>{{ transaction.amount }}</td>
                <td>{{ transaction.balance }}</td>
                <td>
                  <a href="{{ url_for('transactions.edit_transaction', transaction_id=transaction.id) }}" class="btn btn-sm btn-primary">Edit</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        </form>

      </div>
    </div>

  </div>
</div>

<script>
    // JavaScript to handle "Select All" functionality
    document.getElementById('select-all').addEventListener('change', function () {
        const checkboxes = document.querySelectorAll('input[name="transaction_ids"]');
        checkboxes.forEach(checkbox => checkbox.checked = this.checked);
    });
</script>

{% endblock %}
